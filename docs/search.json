[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "GEI Europa ‚Äî Resumen",
    "section": "",
    "text": "Bienvenido/a\nEste sitio publica el an√°lisis y el pron√≥stico de emisiones de gases de efecto invernadero en Europa.\n\nüìÑ Informe completo: GCEU\nüì¶ Repositorio: (este mismo proyecto en GitHub)\n\n\nNota: Los gr√°ficos interactivos (dygraphs, DT, etc.) se renderizan al compilar el sitio."
  },
  {
    "objectID": "GCEU.html",
    "href": "GCEU.html",
    "title": "Analisis temporal de la expulsion de gases de efecto invernadero europeos",
    "section": "",
    "text": "Este proyecto consiste en el estudio de las series temporales sobre un caso pr√°ctico. Se implementaran para ello diversos m√©todos estad√≠sticos con el fin de crear modelos que se ajusten lo mejor posible a nuestro caso practico. Tales m√©todos como los modelos ARIMA nos permitir√°n modelar y predecir estos procesos estoc√°sticos. Adem√°s de estas t√©cnicas se utilizar√°n cartograf√≠as para la previsualizaci√≥n de estas series temporales.\nEl estudio de nuestro caso pr√°ctico recopila informaci√≥n de los gases de efecto invernadero expulsados por la uni√≥n europea desde el a√±o 2008 hasta el primer cuatrimestre de 2025.\n\n\n\n\nLos datos utilizados para este estudio los obtenemos via eurostat. Este es el enlace: https://ec.europa.eu/eurostat/databrowser/view/env_ac_aigg_q/default/table?lang=en\n\n\nCode\nlibrary(eurostat)\n\n\nWarning: package 'eurostat' was built under R version 4.4.3\n\n\nCode\ndatos = get_eurostat(\"env_ac_aigg_q\")\n\n\nDataset query already saved in cache_list.json...\n\n\nReading cache file C:\\Users\\emk\\AppData\\Local\\Temp\\RtmpUnnzvx/eurostat/6c1f659ce62d01cfc685172c15dfcbe6.rds\n\n\nTable  env_ac_aigg_q  read from cache file:  C:\\Users\\emk\\AppData\\Local\\Temp\\RtmpUnnzvx/eurostat/6c1f659ce62d01cfc685172c15dfcbe6.rds\n\n\nCode\nunique(datos$unit)\n\n\n[1] \"PCH_SM\" \"THS_T\"  \"T_HAB\" \n\n\nLos datos descargados son un un proceso estocastico que transcurre desde el 2010-01-01 hasta el 2023-01-01 y va aumentando de forma trimestral periodicamente.\n\n\n\nLa principal variable de medici√≥n de inter√©s es THS_T (Toneladas de gases de efecto invernadero expulsados).\n\n\nCode\nlibrary(dplyr)\n\n\nWarning: package 'dplyr' was built under R version 4.4.3\n\n\n\nAdjuntando el paquete: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n\nCode\ndatosTT &lt;- datos %&gt;%\n  filter(unit==\"THS_T\") %&gt;%\n  filter(geo!=\"EU27_2020\") \n\n\nEste primer filtrado de los datos se realiza para la posterior visualizaci√≥n y mapeo de los paises europeos.\n\n\n\n\n\n\nPara la creaci√≥n de los mapas es necesario la descarga de una cartograf√≠a que contenga los paises de la Uni√≥n Europea y esto lo realizamos a trav√©s de la p√°gina de eurostat. Este es el enlace: https://ec.europa.eu/eurostat/web/gisco/geodata/reference-data/administrative-units-statistical-units/nuts\n\n\nCode\nlibrary(sf)\n\n\nWarning: package 'sf' was built under R version 4.4.3\n\n\nLinking to GEOS 3.13.0, GDAL 3.10.1, PROJ 9.5.1; sf_use_s2() is TRUE\n\n\nCode\nlibrary(tmap)\n\n\nWarning: package 'tmap' was built under R version 4.4.3\n\n\nCode\nEU_MAP&lt;-st_read(\"C:/EMILIO/UNIVERSIDAD/2022-2023/segundo cuatrimestre/TFG/NUTS_RG_60M_2021_3035.shp\")\n\n\nReading layer `NUTS_RG_60M_2021_3035' from data source \n  `C:\\EMILIO\\UNIVERSIDAD\\2022-2023\\segundo cuatrimestre\\TFG\\NUTS_RG_60M_2021_3035.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 2010 features and 9 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -2823672 ymin: -3077410 xmax: 10027630 ymax: 6401639\nProjected CRS: ETRS89-extended / LAEA Europe\n\n\nCode\nsummary(EU_MAP)\n\n\n   NUTS_ID            LEVL_CODE      CNTR_CODE          NAME_LATN        \n Length:2010        Min.   :0.000   Length:2010        Length:2010       \n Class :character   1st Qu.:3.000   Class :character   Class :character  \n Mode  :character   Median :3.000   Mode  :character   Mode  :character  \n                    Mean   :2.654                                        \n                    3rd Qu.:3.000                                        \n                    Max.   :3.000                                        \n                                                                         \n  NUTS_NAME           MOUNT_TYPE      URBN_TYPE       COAST_TYPE   \n Length:2010        Min.   :0.000   Min.   :0.000   Min.   :0.000  \n Class :character   1st Qu.:2.000   1st Qu.:1.000   1st Qu.:1.000  \n Mode  :character   Median :4.000   Median :2.000   Median :2.000  \n                    Mean   :2.709   Mean   :1.536   Mean   :1.768  \n                    3rd Qu.:4.000   3rd Qu.:2.000   3rd Qu.:3.000  \n                    Max.   :4.000   Max.   :3.000   Max.   :3.000  \n                    NA's   :1                                      \n     FID                     geometry   \n Length:2010        MULTIPOLYGON :2010  \n Class :character   epsg:3035    :   0  \n Mode  :character   +proj=laea...:   0  \n                                        \n                                        \n                                        \n                                        \n\n\nCode\nsummary(EU_MAP$LEVL_CODE)\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   3.000   3.000   2.654   3.000   3.000 \n\n\n\n\nCode\nst_crs(EU_MAP)\n\n\nCoordinate Reference System:\n  User input: ETRS89-extended / LAEA Europe \n  wkt:\nPROJCRS[\"ETRS89-extended / LAEA Europe\",\n    BASEGEOGCRS[\"ETRS89\",\n        ENSEMBLE[\"European Terrestrial Reference System 1989 ensemble\",\n            MEMBER[\"European Terrestrial Reference Frame 1989\"],\n            MEMBER[\"European Terrestrial Reference Frame 1990\"],\n            MEMBER[\"European Terrestrial Reference Frame 1991\"],\n            MEMBER[\"European Terrestrial Reference Frame 1992\"],\n            MEMBER[\"European Terrestrial Reference Frame 1993\"],\n            MEMBER[\"European Terrestrial Reference Frame 1994\"],\n            MEMBER[\"European Terrestrial Reference Frame 1996\"],\n            MEMBER[\"European Terrestrial Reference Frame 1997\"],\n            MEMBER[\"European Terrestrial Reference Frame 2000\"],\n            MEMBER[\"European Terrestrial Reference Frame 2005\"],\n            MEMBER[\"European Terrestrial Reference Frame 2014\"],\n            MEMBER[\"European Terrestrial Reference Frame 2020\"],\n            ELLIPSOID[\"GRS 1980\",6378137,298.257222101,\n                LENGTHUNIT[\"metre\",1]],\n            ENSEMBLEACCURACY[0.1]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4258]],\n    CONVERSION[\"Europe Equal Area 2001\",\n        METHOD[\"Lambert Azimuthal Equal Area\",\n            ID[\"EPSG\",9820]],\n        PARAMETER[\"Latitude of natural origin\",52,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",10,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"False easting\",4321000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",3210000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (Y)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (X)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Statistical analysis.\"],\n        AREA[\"Europe - European Union (EU) countries and candidates. Europe - onshore and offshore: Albania; Andorra; Austria; Belgium; Bosnia and Herzegovina; Bulgaria; Croatia; Cyprus; Czechia; Denmark; Estonia; Faroe Islands; Finland; France; Germany; Gibraltar; Greece; Hungary; Iceland; Ireland; Italy; Kosovo; Latvia; Liechtenstein; Lithuania; Luxembourg; Malta; Monaco; Montenegro; Netherlands; North Macedonia; Norway including Svalbard and Jan Mayen; Poland; Portugal including Madeira and Azores; Romania; San Marino; Serbia; Slovakia; Slovenia; Spain including Canary Islands; Sweden; Switzerland; T√ºrkiye (Turkey); United Kingdom (UK) including Channel Islands and Isle of Man; Vatican City State.\"],\n        BBOX[24.6,-35.58,84.73,44.83]],\n    ID[\"EPSG\",3035]]\n\n\nObtenemos el sistema de referencia que se utiliza en esta cartograf√≠a, as√≠ como los paises y sus repectivas islas ilustradas en el.\n\n\nCode\ntm_shape(EU_MAP)+\n  tm_borders()\n\n\n\n\n\n\n\n\n\nLas graficamos para visualizar y observamos como la cartografia contiene a parte de los paises todos los respectivos multipoligonos asociados a los pueblos y las comunidades autonomas.Por eso es necesario realizar un filtro en la cartografia y quedarnos solo con los NUTS=0 es decir los paises.\n\n\nCode\nEU_MAP &lt;- EU_MAP %&gt;%\n    filter(LEVL_CODE==0)\n\ntm_shape(EU_MAP)+\n  tm_borders()\n\n\n\n\n\n\n\n\n\nUna vez que nuestra cartografia se coresponde con nuestro objetivo de estudio es momento de unir los datos a la cartografia. Pero nuestra base de datos no contiene informacion de todos los paises pertenecientes a la cartografia por tanto habr√° que unirlos solo para los que tenemos informaci√≥n.\n\n\n\n\n\nCode\nEU_mapa&lt;-dplyr::left_join(EU_MAP, datosTT, by=c(\"NUTS_ID\"=\"geo\"))\n\nEU_mapa &lt;- EU_mapa %&gt;%\n  filter(values != \"NA\")\n\n\n\n\n\nFiltramos un trimestre aleatorio para visualizar si todo esta en orden.\n\n\nCode\nEU_mapa2207 &lt;- EU_mapa %&gt;%\n  filter(TIME_PERIOD==\"2024-07-01\")\n\ntm_shape(EU_mapa2207,)+\n  tm_fill(palette =\"Blues\",col = \"values\",style = \"quantile\")\n\n\n\n\n\n‚îÄ‚îÄ tmap v3 code detected ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n\n[v3-&gt;v4] `tm_polygons()`: instead of `style = \"quantile\"`, use fill.scale =\n`tm_scale_intervals()`.\n‚Ñπ Migrate the argument(s) 'style', 'palette' (rename to 'values') to\n  'tm_scale_intervals(&lt;HERE&gt;)'\n[v3-&gt;v4] `tm_polygons()`: use 'fill' for the fill color of polygons/symbols\n(instead of 'col'), and 'col' for the outlines (instead of 'border.col').\n[cols4all] color palettes: use palettes from the R package cols4all. Run\n`cols4all::c4a_gui()` to explore them. The old palette name \"Blues\" is named\n\"brewer.blues\"\nMultiple palettes called \"blues\" found: \"brewer.blues\", \"matplotlib.blues\". The first one, \"brewer.blues\", is returned.\n\n\n\n\n\n\n\n\n\nLa cartografia por culpa de las islas de algunos paises queda muy alejada y la visualizaci√≥n no es buena, por lo que transformamos la caja para visualizar mejor.\nGeneramos una BBDD con las medias de los valores de cada pais a lo largo del tiempo para poder visualizar bien la importancia de cada pa√≠s.\n\n\nCode\nEU_mapa_media &lt;- EU_mapa %&gt;%\n    group_by(NUTS_NAME) %&gt;%        \n    summarise(media_value = mean(values, na.rm = TRUE)) %&gt;% \n    ungroup()\n\n#ahora visualizamos la importancia de cada pa√≠s.\ntmap_mode(\"view\")\n\n\n‚Ñπ tmap modes \"plot\" - \"view\"\n‚Ñπ toggle with `tmap::ttm()`\n\n\nCode\nbbox_eu &lt;- st_bbox(c(xmin = -20, ymin = 30, xmax = 40, ymax = 67), crs = 4326)\n\n\ntm_shape(EU_mapa_media, bbox = bbox_eu) +\n  tm_polygons(\n    fill = \"media_value\",\n    fill.scale = tm_scale(\n      breaks = c(0, 14000, 36000, 68000, 92000, 150000, 280000),\n      values = \"brewer.yl_or_rd\",  # antes: \"YlOrRd\"\n      labels = c(\"‚â§ 14k\", \"14k ‚Äì 36k\", \"36k ‚Äì 68k\", \"68k ‚Äì 92k\", \"92k - 150k\",\"&gt;150k\")\n    ),\n    fill.legend = tm_legend(title = \"Toneladas GEI expulsadas\", outside = TRUE)\n  ) +\n  tm_view(view.zoom = 5) +\n  tm_layout(frame = FALSE) +\n  tm_title(\"Emisiones de Gases de Efecto Invernadero en media en Europa 2008-2024\")\n\n\n\n\n\n\n\nVisualizamos como claramente Alemania es el pa√≠s que m√°s GEI expulsa, seguido por Francia, Italia y Polonia.\n\n\n\n\n\n\n\nPara empezar vamos a filtrar nuestra base de datos y crear nuestros objetos en series temporales para su posterior analisis. Lo primero va a ser visualizar las gr√°ficas para obtener informaci√≥n de su comportamiento.\n\n\nCode\nlibrary(dplyr)\nlibrary(forecast)\n\n\nWarning: package 'forecast' was built under R version 4.4.3\n\n\nRegistered S3 method overwritten by 'quantmod':\n  method            from\n  as.zoo.data.frame zoo \n\n\nCode\nlibrary(ggplot2)\n\n\nWarning: package 'ggplot2' was built under R version 4.4.3\n\n\nCode\nlibrary(stats)\n\ndatosEU_THS_T &lt;- datos %&gt;%\n  filter(unit==\"THS_T\") %&gt;%\n  filter(geo==\"EU27_2020\") %&gt;%\n  filter(nace_r2==\"TOTAL_HH\") %&gt;%\n  arrange(TIME_PERIOD)\n\ndatosEU_THS_T.ts &lt;- ts(datosEU_THS_T$values,end=c(2025,1),frequency =4)\n\n\nggtsdisplay(datosEU_THS_T.ts,main=\"Expulsion de gases de efecto invernadero en EUROPA\",xlab=\"A√ëO\",ylab=\"MIlies de toneladas\")\n\n\n\n\n\n\n\n\n\nCode\nfitTHS &lt;- decompose(datosEU_THS_T.ts, type='additive')\nautoplot(fitTHS)+\n  labs(title = \"Expulsion de gases de efecto invernadero en Europa\",                   \n       x = \"Tiempo\",\n       y = \"Miles de toneladas\",\n       colour = \"Gears\")+\n    theme_bw()\n\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `linewidth` instead.\n‚Ñπ The deprecated feature was likely used in the forecast package.\n  Please report the issue at &lt;https://github.com/robjhyndman/forecast/issues&gt;.\n\n\nIgnoring unknown labels:\n‚Ä¢ colour : \"Gears\"\n\n\n\n\n\n\n\n\n\nSe observa una estacionalidad trimestral super clara a parte de una tendencia decreciente a lo largo de toda la serie salvo por el momento del efecto inverso del covid. Tambi√©n observamos una falta de estacionariedad clara y por tanto ni nos fijamos en los coeficientes de autocorrelaci√≥n.\nCreamos otra grafica para visualizar Mejor:\n\n\nCode\nautoplot(datosEU_THS_T.ts, series=\"Serie Temporal\") + \n    autolayer(trendcycle(fitTHS), series=\"Tendencia\") +\n    labs(title = \"Expulsi√≥n de gases de efecto invernadero en Europa\",      \n       x = \"A√±os\",\n       y = \"Miles de toneladas\"\n       ) + \n    theme_bw()\n\n\nWarning: Removed 4 rows containing missing values or values outside the scale range\n(`geom_line()`).\n\n\n\n\n\n\n\n\n\nUna vez visualizado la tendencia de forma mas grafica pasamos a intentar entender mejor la estacionaidad de nuestra serie.\n\n\nCode\nggseasonplot(datosEU_THS_T.ts)\n\n\n\n\n\n\n\n\n\nCode\nsummary(datosEU_THS_T$values)\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 734660  915330  958964  970101 1054939 1187357 \n\n\nY como podemos observar, hay una clara estacionalidad. En los segundos y terceros trimestres del a√±o los europeos expulsamos menos gases de efecto invernadero que en el primer y cuarto trimestre. Lo m√°s probable debido a las temperaturas bajas de esos momentos(oto√±o/invierno) y el uso de energ√≠as contaminantes para la generaci√≥n de calor.\n\n\n\n\n\nComo habiamos dicho anteriormente se ha observado claramente falta de estacionariedad y por tanto tendremos que estabilizar la serie y desestacionalizarla.\n\n\nPasamos a probar cuantas diferenciaciones ser√°n necesarias para estabilizar las series.\n\n\nCode\nndiffs(datosEU_THS_T.ts)#regulares\n\n\n[1] 1\n\n\nCode\nnsdiffs(datosEU_THS_T.ts)#estacionales\n\n\n[1] 1\n\n\nPor tanto va a ser necesario realizar una diferencia regular y una estacional para estacionarizar las dos series temporales del estudio.\n\n\n\n\nCode\nlibrary(forecast)\ndiff.datosEU_THS_T.ts&lt;-diff(datosEU_THS_T.ts)\nplot(datosEU_THS_T.ts,main=\"serie sin diferenciar\",col=\"purple\")\n\n\n\n\n\n\n\n\n\nCode\nplot(diff.datosEU_THS_T.ts,main=\"serie diferenciada regularmente\",col=\"purple\")\n\n\n\n\n\n\n\n\n\nCode\nplot(decompose(diff.datosEU_THS_T.ts))\n\n\n\n\n\n\n\n\n\nAhora observamos como las series se han estabilizado en media, pero siguen conteniendo la parte estacional y aleatoria del modelo, por ello tenemos que diferenciar estacionalmente.\n\n\n\n\n\nCode\ndiff.datosEU_THS_T.ts.4&lt;-diff(diff.datosEU_THS_T.ts, lag = 4)\nplot(datosEU_THS_T.ts,main=\"serie sin diferenciar\",col=\"purple\")\n\n\n\n\n\n\n\n\n\nCode\nplot(diff.datosEU_THS_T.ts.4,main=\"serie con una diferencia regular y otra estacional\",col=\"purple\")\n\n\n\n\n\n\n\n\n\nNo observamos heterocedasticidad y por tanto no va a ser necesaria hacer ninguna transformaci√≥n logaritmica o de box-cox. A parte podemos confirmar como se ha eliminado la estacionalidad de la serie y por tanto podemos pasar a intentar visualizar las autocorrelaciones del modelo estacionario para que nos de una idea de que modelo ARIMA nos permitir√° modelar dicha serie.\nUna vez supuesta la hip√≥tesis de estacionariedad hay que comprobarla y eso lo relizamos a traves del contraste dickey fuller aumentado.\n\n\n\n\n\nCode\nlibrary(tseries)\n\n\nWarning: package 'tseries' was built under R version 4.4.3\n\n\nCode\nadf&lt;-adf.test(diff.datosEU_THS_T.ts.4)\n\n\nWarning in adf.test(diff.datosEU_THS_T.ts.4): p-value smaller than printed\np-value\n\n\nCode\nadf$p.value\n\n\n[1] 0.01\n\n\nHay evidencias estad√≠sticas suficientes para rechazar la hip√≥tesis nula de raiz unitaria ya que el pvalor obtenido es menor a 0.01, es decir, menor que el nivel de confianza del test. Por tanto la serie se puede considerar estacionaria en media y en varianza.\n\n\n\n\n\n\nCode\nAcf(diff.datosEU_THS_T.ts.4)\n\n\n\n\n\n\n\n\n\nCode\nPacf(diff.datosEU_THS_T.ts.4)\n\n\n\n\n\n\n\n\n\nCode\nggtsdisplay(diff.datosEU_THS_T.ts.4)\n\n\n\n\n\n\n\n\n\nObservamos como decrece rapidamente la funcion de autocorrelacion simple y que en la funci√≥n de autocorelacion parcial sobresale el primer y cuarto autorregresor, por tanto el modelo ARIMA puede que necesite un paremetro p=1 o 4 a parte de alguna diferenciaci√≥n y por tanto su parametro d puede que tome el valor de la unidad tambi√©n.\n\n\n\n\n\n\nUna vez que hayamos conseguido que la serie sea estacionaria para obtener informaci√≥n de sus autocorrelaciones es hora de identificicar los posibles modelos que mejor se ajusten a nuestra serie original. Para ello probamos distintos modelos ARIMA para a posteriori decidir cual nos convence mas a trav√©s de los estad√≠sticos Akaike y BIC.\n\n\nCode\nlibrary(forecast)\narima1&lt;- Arima(datosEU_THS_T.ts, order=c(0,1,2), seasonal=list(order=c(0,1,1),period=4))\narima2&lt;- Arima(datosEU_THS_T.ts, order=c(1,1,0), seasonal=list(order=c(1,1,1),period=4))\narima3&lt;- Arima(datosEU_THS_T.ts, order=c(1,1,1), seasonal=list(order=c(1,1,0),period=4))\narima4&lt;- Arima(datosEU_THS_T.ts, order=c(1,1,1), seasonal=list(order=c(1,1,1),period=4))\narima5&lt;- Arima(datosEU_THS_T.ts, order=c(1,1,2), seasonal=list(order=c(1,1,1),period=4))\narima6&lt;- Arima(datosEU_THS_T.ts, order=c(0,1,1), seasonal=list(order=c(0,1,1),period=4))\narima7&lt;- Arima(datosEU_THS_T.ts, order=c(1,1,0), seasonal=list(order=c(1,1,0),period=4))\narima8&lt;- Arima(datosEU_THS_T.ts, order=c(1,0,0), seasonal=list(order=c(0,1,1),period=4))\narima9&lt;- Arima(datosEU_THS_T.ts, order=c(0,1,0), seasonal=list(order=c(0,1,1),period=4))\n\n\n\n\n\n\n\nCode\n#Para la serie de miles de toneladas\nAIC(arima1,arima2,arima3,arima4,arima5,arima6,arima7,arima8,arima9)\n\n\nWarning in AIC.default(arima1, arima2, arima3, arima4, arima5, arima6, arima7,\n: No todos los modelos se han ajustado usando el mismo n√∫mero de observaciones\n\n\n       df      AIC\narima1  4 1317.362\narima2  4 1318.073\narima3  4 1327.749\narima4  5 1317.122\narima5  6 1318.990\narima6  3 1315.776\narima7  3 1325.758\narima8  3 1339.630\narima9  2 1316.630\n\n\nCode\nBIC(arima1,arima2,arima3,arima4,arima5,arima6,arima7,arima8,arima9)\n\n\nWarning in BIC.default(arima1, arima2, arima3, arima4, arima5, arima6, arima7,\n: No todos los modelos se han ajustado usando el mismo n√∫mero de observaciones\n\n\n       df      BIC\narima1  4 1325.464\narima2  4 1326.175\narima3  4 1335.850\narima4  5 1327.249\narima5  6 1331.142\narima6  3 1321.852\narima7  3 1331.834\narima8  3 1345.759\narima9  2 1320.681\n\n\nSeg√∫n el estad√≠stico akaike el modelo que minimiza la perdida de informac√≠on ser√≠a el arima6 y luego el arima9;\nARIMA6 (p=0,d=1,q=1)(P=0,D=1,Q=1)4\nARIMA9 (p=0,d=1,q=0)(P=0,D=1,Q=1)4\n\n\n\nvisualizamos los errores de los modelos para luego contrstar la normalidad de estos:\nEn modelos ARIMA para series macroecon√≥micas o ambientales, la normalidad perfecta de residuos rara vez se cumple.\n\n\nCode\ncheckresiduals(arima6)\n\n\n\n\n\n\n\n\n\n\n    Ljung-Box test\n\ndata:  Residuals from ARIMA(0,1,1)(0,1,1)[4]\nQ* = 7.8306, df = 6, p-value = 0.2508\n\nModel df: 2.   Total lags used: 8\n\n\nTu SARIMA(0,1,1)(0,1,1)[4] es v√°lido estad√≠sticamente. Es normal que Shapiro-Wilk d√© p &lt; 0.05 aunque Ljung-Box sea correcto. Lo importante aqu√≠ es el Ljung-Box, no la normalidad perfecta.\n\n\nCode\ncheckresiduals(arima9)\n\n\n\n\n\n\n\n\n\n\n    Ljung-Box test\n\ndata:  Residuals from ARIMA(0,1,0)(0,1,1)[4]\nQ* = 12.363, df = 7, p-value = 0.08922\n\nModel df: 1.   Total lags used: 8\n\n\nVamos que el pvalor de este arima9 es bastante peor que el del arima6, y como los estad√≠sticos akaike y BIC tambi√©n les pasaba levemente eso lo descartamos y nos quedamos definitivamente con el modelo arima6.\nAhora pasamos a ver si los parametros de nuestros modelos son significativos.\n\n\nCode\nlibrary(lmtest)\n\n\nWarning: package 'lmtest' was built under R version 4.4.3\n\n\nCargando paquete requerido: zoo\n\n\nWarning: package 'zoo' was built under R version 4.4.3\n\n\n\nAdjuntando el paquete: 'zoo'\n\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n\n\nCode\ncoeftest(arima6) #el par√°metro de media movil etsacional sale significativo.\n\n\n\nz test of coefficients:\n\n     Estimate Std. Error z value  Pr(&gt;|z|)    \nma1  -0.24465    0.13965 -1.7519   0.07978 .  \nsma1 -0.81723    0.11101 -7.3618 1.814e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nEn el modelo SARIMA(0,1,1)(0,1,1)[4], el coeficiente estacional SMA(1) resulta altamente significativo (p &lt; 0.001), lo que confirma una fuerte dependencia estacional trimestral en las emisiones de gases de efecto invernadero de la UE. El coeficiente MA(1) presenta un valor pr√≥ximo a la significaci√≥n estad√≠stica (p ‚âà 0.08), lo cual, junto con los criterios de informaci√≥n m√°s bajos y la ausencia de autocorrelaci√≥n en los residuos, justifica su inclusi√≥n. Por tanto, el modelo se considera adecuadamente especificado para realizar pron√≥sticos.\n\n\nCode\nBox.test(arima6$residuals, lag = 20, type = \"Ljung-Box\")\n\n\n\n    Box-Ljung test\n\ndata:  arima6$residuals\nX-squared = 17.535, df = 20, p-value = 0.618\n\n\nComo el p-valore(0.618) supera al nivel de significaci√≥n 0.05, afirmamos la hip√≥tesis nula y por tanto confirmamos que los residuos estan incorrelados. De tal manera ahora tenemos nuestro modelo comprobado y podemos pasar a predecir con el.\n\n\n\n\nPasamos a visualizar las predicciones para la serie de toneladas de gases de efecto invernadero expulsados per c√°pita.\n\n\nCode\nlibrary(forecast)\nlibrary(dygraphs)\n\n# Escalar a millones de toneladas\nserie_mill &lt;- datosEU_THS_T.ts / 1e6\n\n# Forecast y escala\nprediccionesTHS &lt;- forecast(arima6, level = 95, h = 10)\npred_mill &lt;- prediccionesTHS$mean / 1e6\n\ndygraph(\n  cbind(Serie = serie_mill, Predicci√≥n = pred_mill),\n  main = \"GEI expulsados por la UE\"\n) %&gt;%\n  dySeries(\"Serie\", label = \"Hist√≥rico\", strokeWidth = 2) %&gt;%\n  dySeries(\"Predicci√≥n\", label = \"Pron√≥stico\", strokeWidth = 3, strokePattern = \"dashed\") %&gt;%\n  dyAxis(\"y\", label = \"Millones de toneladas\") %&gt;%\n  dyAxis(\"x\", label = \"A√±o\") %&gt;%\n  dyOptions(\n    drawGrid = TRUE,\n    useDataTimezone = FALSE,\n    fillGraph = FALSE,\n    strokeWidth = 2,\n    titleHeight = 40\n  ) %&gt;%\n  dyLegend(show = \"always\") %&gt;%\n  dyHighlight(\n    highlightCircleSize = 5,\n    highlightSeriesBackgroundAlpha = 0.25,\n    hideOnMouseOut = FALSE\n  ) %&gt;%\n  dyRangeSelector(height = 30)\n\n\n\n\n\n\nAhora voy a graficar los datos de una forma que pueda comparar los trimestres de cada a√±o de una forma clara y visual.\n\n\nCode\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(zoo)     # para yearqtr\nlibrary(scales)  # para etiquetas bonitas\n\n# Escala a millones\nserie_mill &lt;- as.numeric(datosEU_THS_T.ts) / 1e6 #As√≠ las unidades est√°n en millones de toneladas\nti &lt;- as.yearqtr(time(datosEU_THS_T.ts)) #Formato de cuartos de a√±o para poder visualizar bien\n\ndf_q &lt;- tibble::tibble(\n  Year    = as.integer(format(ti, \"%Y\")),\n  Quarter = factor(format(ti, \"Q%q\"), levels = c(\"Q1\",\"Q2\",\"Q3\",\"Q4\")),\n  Value   = serie_mill\n)\n\nggplot(df_q, aes(x = factor(Year), y = Quarter, fill = Value)) +\n  geom_tile() +\n  scale_fill_viridis_c(name = \"Mill. t\") +\n  labs(title = \"Mapa de calor: emisiones por trimestre y a√±o\",\n       x = \"A√±o\", y = \"Trimestre\") +\n  theme_minimal(base_size = 12) +\n  theme(panel.grid = element_blank(),\n        axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\n\n\n\n\nCode\nggplot(df_q, aes(x = Quarter, y = Value)) +\n  geom_boxplot(outlier.alpha = 0.3) +\n  geom_jitter(width = 0.1, alpha = 0.4) +\n  scale_y_continuous(labels = label_number(big.mark = \".\", decimal.mark = \",\")) +\n  labs(title = \"Distribuci√≥n hist√≥rica por trimestre\",\n       x = \"Trimestre\", y = \"Millones de toneladas\") +\n  theme_minimal(base_size = 12)\n\n\n\n\n\n\n\n\n\nEn el mapa de calor y en este gr√°fico boxplot segmentado por trimestres se aprecia muy bien la estacionalidad de los datos.\n\n\nCode\nlibrary(forecast)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(zoo)\nlibrary(DT)\n\n# --- 1) Serie y forecast en millones ---\nserie_mill &lt;- as.numeric(datosEU_THS_T.ts) / 1e6\npred &lt;- forecast(arima6, h = 10)\npred_mill &lt;- as.numeric(pred$mean) / 1e6\n\n# --- 2) √çndices de tiempo correctos (trimestral) ---\nti_hist &lt;- as.yearqtr(time(datosEU_THS_T.ts))\nti_pred &lt;- as.yearqtr(time(pred$mean))\n\ndf_hist &lt;- tibble(\n  Year    = as.integer(format(ti_hist, \"%Y\")),\n  Quarter = factor(format(ti_hist, \"Q%q\"), levels = c(\"Q1\",\"Q2\",\"Q3\",\"Q4\")),\n  Value   = serie_mill,\n  Pred    = FALSE\n)\n\ndf_pred &lt;- tibble(\n  Year    = as.integer(format(ti_pred, \"%Y\")),\n  Quarter = factor(format(ti_pred, \"Q%q\"), levels = c(\"Q1\",\"Q2\",\"Q3\",\"Q4\")),\n  Value   = pred_mill,\n  Pred    = TRUE\n)\n\ndf &lt;- bind_rows(df_hist, df_pred) %&gt;%\n  arrange(Year, Quarter)\n\n# --- 3) Pasar a formato ancho (a√±os x trimestres) ---\nvalue_wide &lt;- df %&gt;%\n  select(Year, Quarter, Value) %&gt;%\n  pivot_wider(names_from = Quarter, values_from = Value) %&gt;%\n  arrange(Year)\n\nflag_wide &lt;- df %&gt;%\n  select(Year, Quarter, Pred) %&gt;%\n  pivot_wider(names_from = Quarter, values_from = Pred) %&gt;%\n  arrange(Year) %&gt;%\n  rename(Q1_pred = Q1, Q2_pred = Q2, Q3_pred = Q3, Q4_pred = Q4)\n\ntabla &lt;- value_wide %&gt;%\n  left_join(flag_wide, by = \"Year\")\n\n# --- 4) Tabla interactiva con predicciones coloreadas ---\nDT::datatable(\n  tabla,\n  rownames = FALSE,\n  caption = \"Emisiones por a√±o y trimestre (millones de toneladas). Las celdas coloreadas son predicciones.\",\n  options = list(\n    pageLength = 50,\n    dom = \"tip\",\n    columnDefs = list(\n      # Ocultar columnas auxiliares de predicci√≥n\n      list(visible = FALSE,\n           targets = which(names(tabla) %in% c(\"Q1_pred\",\"Q2_pred\",\"Q3_pred\",\"Q4_pred\")) - 1)\n    )\n  )\n) %&gt;%\n  formatRound(c(\"Q1\",\"Q2\",\"Q3\",\"Q4\"), 2) %&gt;%\n  # Colorear las predicciones usando las columnas *_pred ocultas\n  formatStyle('Q1', backgroundColor = styleEqual(c(TRUE, FALSE), c(\"#e3f2fd\", \"white\")),\n              valueColumns = \"Q1_pred\") %&gt;%\n  formatStyle('Q2', backgroundColor = styleEqual(c(TRUE, FALSE), c(\"#e3f2fd\", \"white\")),\n              valueColumns = \"Q2_pred\") %&gt;%\n  formatStyle('Q3', backgroundColor = styleEqual(c(TRUE, FALSE), c(\"#e3f2fd\", \"white\")),\n              valueColumns = \"Q3_pred\") %&gt;%\n  formatStyle('Q4', backgroundColor = styleEqual(c(TRUE, FALSE), c(\"#e3f2fd\", \"white\")),\n              valueColumns = \"Q4_pred\")\n\n\n\n\n\n\n\n\n\n\nEl an√°lisis realizado permite caracterizar con precisi√≥n la evoluci√≥n reciente de las emisiones de gases de efecto invernadero en Europa y ofrecer una proyecci√≥n s√≥lida a corto y medio plazo. Tras el ajuste y validaci√≥n del modelo SARIMA(0,1,1)(0,1,1)[4], los resultados muestran una continuidad en la tendencia descendente observada durante la √∫ltima d√©cada, marcada tanto por mejoras tecnol√≥gicas como por pol√≠ticas clim√°ticas m√°s estrictas.\nLas previsiones a partir del segundo trimestre de 2025 indican que las emisiones seguir√°n reduci√©ndose de forma moderada y estable. En t√©rminos intertrimestrales, se espera que los valores permanezcan dentro de rangos similares a los actuales, mientras que la evoluci√≥n interanual anticipa disminuciones progresivas y consistentes. Por ejemplo, los niveles estimados para 2026 y 2027 contin√∫an situ√°ndose por debajo de los registrados en 2024 y 2025, consolidando una trayectoria de descenso estructural.\nEl patr√≥n estacional ‚Äîcon m√≠nimos habituales en los trimestres centrales del a√±o y repuntes suaves en invierno‚Äî se mantiene, pero en todos los casos con valores m√°s bajos respecto a a√±os anteriores. Esto sugiere que el proceso de descarbonizaci√≥n europeo no solo contin√∫a, sino que se profundiza.\nEn conjunto, el an√°lisis confirma que Europa avanza hacia una reducci√≥n sostenida de sus emisiones, sin indicios de incrementos significativos a corto plazo. Las previsiones reforzan la conclusi√≥n de que las medidas implementadas est√°n teniendo un efecto apreciable, y que, salvo perturbaciones externas importantes, la tendencia decreciente se mantendr√° m√°s all√° de 2027.\n\n\n\nUna posible extensi√≥n natural de este trabajo consiste en desagregar la serie temporal por sectores econ√≥micos, aprovechando la clasificaci√≥n NACE_R2 incluida en el conjunto de datos. En este proyecto se ha analizado la serie agregada de ‚Äúactividades totales‚Äù, pero los datos disponibles permiten estudiar de manera independiente sectores como la agricultura, la industria manufacturera, la construcci√≥n, los servicios, el transporte o el suministro de electricidad y gas, entre otros.\nRealizar un an√°lisis temporal por cada categor√≠a permitir√≠a identificar qu√© sectores contribuyen en mayor medida a la evoluci√≥n de las emisiones y c√≥mo var√≠a su peso relativo a lo largo del tiempo. Adem√°s, se podr√≠an comparar patrones estacionales, evaluar el impacto de pol√≠ticas sectoriales espec√≠ficas y modelar predicciones diferenciadas para cada actividad econ√≥mica.\nEste enfoque abrir√≠a la puerta a modelos multivariantes o descomposiciones estructurales, as√≠ como a la posibilidad de estimar la aportaci√≥n marginal de cada sector a las variaciones trimestrales de GEI. En conjunto, estas l√≠neas ampliar√≠an la capacidad explicativa del an√°lisis y proporcionar√≠an una visi√≥n m√°s detallada del comportamiento de las emisiones en Europa."
  },
  {
    "objectID": "GCEU.html#obtenci√≥n-y-tratamiento-de-los-datos.",
    "href": "GCEU.html#obtenci√≥n-y-tratamiento-de-los-datos.",
    "title": "Analisis temporal de la expulsion de gases de efecto invernadero europeos",
    "section": "",
    "text": "Los datos utilizados para este estudio los obtenemos via eurostat. Este es el enlace: https://ec.europa.eu/eurostat/databrowser/view/env_ac_aigg_q/default/table?lang=en\n\n\nCode\nlibrary(eurostat)\n\n\nWarning: package 'eurostat' was built under R version 4.4.3\n\n\nCode\ndatos = get_eurostat(\"env_ac_aigg_q\")\n\n\nDataset query already saved in cache_list.json...\n\n\nReading cache file C:\\Users\\emk\\AppData\\Local\\Temp\\RtmpUnnzvx/eurostat/6c1f659ce62d01cfc685172c15dfcbe6.rds\n\n\nTable  env_ac_aigg_q  read from cache file:  C:\\Users\\emk\\AppData\\Local\\Temp\\RtmpUnnzvx/eurostat/6c1f659ce62d01cfc685172c15dfcbe6.rds\n\n\nCode\nunique(datos$unit)\n\n\n[1] \"PCH_SM\" \"THS_T\"  \"T_HAB\" \n\n\nLos datos descargados son un un proceso estocastico que transcurre desde el 2010-01-01 hasta el 2023-01-01 y va aumentando de forma trimestral periodicamente.\n\n\n\nLa principal variable de medici√≥n de inter√©s es THS_T (Toneladas de gases de efecto invernadero expulsados).\n\n\nCode\nlibrary(dplyr)\n\n\nWarning: package 'dplyr' was built under R version 4.4.3\n\n\n\nAdjuntando el paquete: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n\nCode\ndatosTT &lt;- datos %&gt;%\n  filter(unit==\"THS_T\") %&gt;%\n  filter(geo!=\"EU27_2020\") \n\n\nEste primer filtrado de los datos se realiza para la posterior visualizaci√≥n y mapeo de los paises europeos."
  },
  {
    "objectID": "GCEU.html#mapeo-y-visualizaci√≥n-de-los-datos.",
    "href": "GCEU.html#mapeo-y-visualizaci√≥n-de-los-datos.",
    "title": "Analisis temporal de la expulsion de gases de efecto invernadero europeos",
    "section": "",
    "text": "Para la creaci√≥n de los mapas es necesario la descarga de una cartograf√≠a que contenga los paises de la Uni√≥n Europea y esto lo realizamos a trav√©s de la p√°gina de eurostat. Este es el enlace: https://ec.europa.eu/eurostat/web/gisco/geodata/reference-data/administrative-units-statistical-units/nuts\n\n\nCode\nlibrary(sf)\n\n\nWarning: package 'sf' was built under R version 4.4.3\n\n\nLinking to GEOS 3.13.0, GDAL 3.10.1, PROJ 9.5.1; sf_use_s2() is TRUE\n\n\nCode\nlibrary(tmap)\n\n\nWarning: package 'tmap' was built under R version 4.4.3\n\n\nCode\nEU_MAP&lt;-st_read(\"C:/EMILIO/UNIVERSIDAD/2022-2023/segundo cuatrimestre/TFG/NUTS_RG_60M_2021_3035.shp\")\n\n\nReading layer `NUTS_RG_60M_2021_3035' from data source \n  `C:\\EMILIO\\UNIVERSIDAD\\2022-2023\\segundo cuatrimestre\\TFG\\NUTS_RG_60M_2021_3035.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 2010 features and 9 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -2823672 ymin: -3077410 xmax: 10027630 ymax: 6401639\nProjected CRS: ETRS89-extended / LAEA Europe\n\n\nCode\nsummary(EU_MAP)\n\n\n   NUTS_ID            LEVL_CODE      CNTR_CODE          NAME_LATN        \n Length:2010        Min.   :0.000   Length:2010        Length:2010       \n Class :character   1st Qu.:3.000   Class :character   Class :character  \n Mode  :character   Median :3.000   Mode  :character   Mode  :character  \n                    Mean   :2.654                                        \n                    3rd Qu.:3.000                                        \n                    Max.   :3.000                                        \n                                                                         \n  NUTS_NAME           MOUNT_TYPE      URBN_TYPE       COAST_TYPE   \n Length:2010        Min.   :0.000   Min.   :0.000   Min.   :0.000  \n Class :character   1st Qu.:2.000   1st Qu.:1.000   1st Qu.:1.000  \n Mode  :character   Median :4.000   Median :2.000   Median :2.000  \n                    Mean   :2.709   Mean   :1.536   Mean   :1.768  \n                    3rd Qu.:4.000   3rd Qu.:2.000   3rd Qu.:3.000  \n                    Max.   :4.000   Max.   :3.000   Max.   :3.000  \n                    NA's   :1                                      \n     FID                     geometry   \n Length:2010        MULTIPOLYGON :2010  \n Class :character   epsg:3035    :   0  \n Mode  :character   +proj=laea...:   0  \n                                        \n                                        \n                                        \n                                        \n\n\nCode\nsummary(EU_MAP$LEVL_CODE)\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   3.000   3.000   2.654   3.000   3.000 \n\n\n\n\nCode\nst_crs(EU_MAP)\n\n\nCoordinate Reference System:\n  User input: ETRS89-extended / LAEA Europe \n  wkt:\nPROJCRS[\"ETRS89-extended / LAEA Europe\",\n    BASEGEOGCRS[\"ETRS89\",\n        ENSEMBLE[\"European Terrestrial Reference System 1989 ensemble\",\n            MEMBER[\"European Terrestrial Reference Frame 1989\"],\n            MEMBER[\"European Terrestrial Reference Frame 1990\"],\n            MEMBER[\"European Terrestrial Reference Frame 1991\"],\n            MEMBER[\"European Terrestrial Reference Frame 1992\"],\n            MEMBER[\"European Terrestrial Reference Frame 1993\"],\n            MEMBER[\"European Terrestrial Reference Frame 1994\"],\n            MEMBER[\"European Terrestrial Reference Frame 1996\"],\n            MEMBER[\"European Terrestrial Reference Frame 1997\"],\n            MEMBER[\"European Terrestrial Reference Frame 2000\"],\n            MEMBER[\"European Terrestrial Reference Frame 2005\"],\n            MEMBER[\"European Terrestrial Reference Frame 2014\"],\n            MEMBER[\"European Terrestrial Reference Frame 2020\"],\n            ELLIPSOID[\"GRS 1980\",6378137,298.257222101,\n                LENGTHUNIT[\"metre\",1]],\n            ENSEMBLEACCURACY[0.1]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4258]],\n    CONVERSION[\"Europe Equal Area 2001\",\n        METHOD[\"Lambert Azimuthal Equal Area\",\n            ID[\"EPSG\",9820]],\n        PARAMETER[\"Latitude of natural origin\",52,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",10,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"False easting\",4321000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",3210000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (Y)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (X)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Statistical analysis.\"],\n        AREA[\"Europe - European Union (EU) countries and candidates. Europe - onshore and offshore: Albania; Andorra; Austria; Belgium; Bosnia and Herzegovina; Bulgaria; Croatia; Cyprus; Czechia; Denmark; Estonia; Faroe Islands; Finland; France; Germany; Gibraltar; Greece; Hungary; Iceland; Ireland; Italy; Kosovo; Latvia; Liechtenstein; Lithuania; Luxembourg; Malta; Monaco; Montenegro; Netherlands; North Macedonia; Norway including Svalbard and Jan Mayen; Poland; Portugal including Madeira and Azores; Romania; San Marino; Serbia; Slovakia; Slovenia; Spain including Canary Islands; Sweden; Switzerland; T√ºrkiye (Turkey); United Kingdom (UK) including Channel Islands and Isle of Man; Vatican City State.\"],\n        BBOX[24.6,-35.58,84.73,44.83]],\n    ID[\"EPSG\",3035]]\n\n\nObtenemos el sistema de referencia que se utiliza en esta cartograf√≠a, as√≠ como los paises y sus repectivas islas ilustradas en el.\n\n\nCode\ntm_shape(EU_MAP)+\n  tm_borders()\n\n\n\n\n\n\n\n\n\nLas graficamos para visualizar y observamos como la cartografia contiene a parte de los paises todos los respectivos multipoligonos asociados a los pueblos y las comunidades autonomas.Por eso es necesario realizar un filtro en la cartografia y quedarnos solo con los NUTS=0 es decir los paises.\n\n\nCode\nEU_MAP &lt;- EU_MAP %&gt;%\n    filter(LEVL_CODE==0)\n\ntm_shape(EU_MAP)+\n  tm_borders()\n\n\n\n\n\n\n\n\n\nUna vez que nuestra cartografia se coresponde con nuestro objetivo de estudio es momento de unir los datos a la cartografia. Pero nuestra base de datos no contiene informacion de todos los paises pertenecientes a la cartografia por tanto habr√° que unirlos solo para los que tenemos informaci√≥n.\n\n\n\n\n\nCode\nEU_mapa&lt;-dplyr::left_join(EU_MAP, datosTT, by=c(\"NUTS_ID\"=\"geo\"))\n\nEU_mapa &lt;- EU_mapa %&gt;%\n  filter(values != \"NA\")\n\n\n\n\n\nFiltramos un trimestre aleatorio para visualizar si todo esta en orden.\n\n\nCode\nEU_mapa2207 &lt;- EU_mapa %&gt;%\n  filter(TIME_PERIOD==\"2024-07-01\")\n\ntm_shape(EU_mapa2207,)+\n  tm_fill(palette =\"Blues\",col = \"values\",style = \"quantile\")\n\n\n\n\n\n‚îÄ‚îÄ tmap v3 code detected ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n\n[v3-&gt;v4] `tm_polygons()`: instead of `style = \"quantile\"`, use fill.scale =\n`tm_scale_intervals()`.\n‚Ñπ Migrate the argument(s) 'style', 'palette' (rename to 'values') to\n  'tm_scale_intervals(&lt;HERE&gt;)'\n[v3-&gt;v4] `tm_polygons()`: use 'fill' for the fill color of polygons/symbols\n(instead of 'col'), and 'col' for the outlines (instead of 'border.col').\n[cols4all] color palettes: use palettes from the R package cols4all. Run\n`cols4all::c4a_gui()` to explore them. The old palette name \"Blues\" is named\n\"brewer.blues\"\nMultiple palettes called \"blues\" found: \"brewer.blues\", \"matplotlib.blues\". The first one, \"brewer.blues\", is returned.\n\n\n\n\n\n\n\n\n\nLa cartografia por culpa de las islas de algunos paises queda muy alejada y la visualizaci√≥n no es buena, por lo que transformamos la caja para visualizar mejor.\nGeneramos una BBDD con las medias de los valores de cada pais a lo largo del tiempo para poder visualizar bien la importancia de cada pa√≠s.\n\n\nCode\nEU_mapa_media &lt;- EU_mapa %&gt;%\n    group_by(NUTS_NAME) %&gt;%        \n    summarise(media_value = mean(values, na.rm = TRUE)) %&gt;% \n    ungroup()\n\n#ahora visualizamos la importancia de cada pa√≠s.\ntmap_mode(\"view\")\n\n\n‚Ñπ tmap modes \"plot\" - \"view\"\n‚Ñπ toggle with `tmap::ttm()`\n\n\nCode\nbbox_eu &lt;- st_bbox(c(xmin = -20, ymin = 30, xmax = 40, ymax = 67), crs = 4326)\n\n\ntm_shape(EU_mapa_media, bbox = bbox_eu) +\n  tm_polygons(\n    fill = \"media_value\",\n    fill.scale = tm_scale(\n      breaks = c(0, 14000, 36000, 68000, 92000, 150000, 280000),\n      values = \"brewer.yl_or_rd\",  # antes: \"YlOrRd\"\n      labels = c(\"‚â§ 14k\", \"14k ‚Äì 36k\", \"36k ‚Äì 68k\", \"68k ‚Äì 92k\", \"92k - 150k\",\"&gt;150k\")\n    ),\n    fill.legend = tm_legend(title = \"Toneladas GEI expulsadas\", outside = TRUE)\n  ) +\n  tm_view(view.zoom = 5) +\n  tm_layout(frame = FALSE) +\n  tm_title(\"Emisiones de Gases de Efecto Invernadero en media en Europa 2008-2024\")\n\n\n\n\n\n\n\nVisualizamos como claramente Alemania es el pa√≠s que m√°s GEI expulsa, seguido por Francia, Italia y Polonia."
  },
  {
    "objectID": "GCEU.html#depuraci√≥n-de-los-datos-y-transformaci√≥n-a-series-temporales.",
    "href": "GCEU.html#depuraci√≥n-de-los-datos-y-transformaci√≥n-a-series-temporales.",
    "title": "Analisis temporal de la expulsion de gases de efecto invernadero europeos",
    "section": "",
    "text": "Para empezar vamos a filtrar nuestra base de datos y crear nuestros objetos en series temporales para su posterior analisis. Lo primero va a ser visualizar las gr√°ficas para obtener informaci√≥n de su comportamiento.\n\n\nCode\nlibrary(dplyr)\nlibrary(forecast)\n\n\nWarning: package 'forecast' was built under R version 4.4.3\n\n\nRegistered S3 method overwritten by 'quantmod':\n  method            from\n  as.zoo.data.frame zoo \n\n\nCode\nlibrary(ggplot2)\n\n\nWarning: package 'ggplot2' was built under R version 4.4.3\n\n\nCode\nlibrary(stats)\n\ndatosEU_THS_T &lt;- datos %&gt;%\n  filter(unit==\"THS_T\") %&gt;%\n  filter(geo==\"EU27_2020\") %&gt;%\n  filter(nace_r2==\"TOTAL_HH\") %&gt;%\n  arrange(TIME_PERIOD)\n\ndatosEU_THS_T.ts &lt;- ts(datosEU_THS_T$values,end=c(2025,1),frequency =4)\n\n\nggtsdisplay(datosEU_THS_T.ts,main=\"Expulsion de gases de efecto invernadero en EUROPA\",xlab=\"A√ëO\",ylab=\"MIlies de toneladas\")\n\n\n\n\n\n\n\n\n\nCode\nfitTHS &lt;- decompose(datosEU_THS_T.ts, type='additive')\nautoplot(fitTHS)+\n  labs(title = \"Expulsion de gases de efecto invernadero en Europa\",                   \n       x = \"Tiempo\",\n       y = \"Miles de toneladas\",\n       colour = \"Gears\")+\n    theme_bw()\n\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `linewidth` instead.\n‚Ñπ The deprecated feature was likely used in the forecast package.\n  Please report the issue at &lt;https://github.com/robjhyndman/forecast/issues&gt;.\n\n\nIgnoring unknown labels:\n‚Ä¢ colour : \"Gears\"\n\n\n\n\n\n\n\n\n\nSe observa una estacionalidad trimestral super clara a parte de una tendencia decreciente a lo largo de toda la serie salvo por el momento del efecto inverso del covid. Tambi√©n observamos una falta de estacionariedad clara y por tanto ni nos fijamos en los coeficientes de autocorrelaci√≥n.\nCreamos otra grafica para visualizar Mejor:\n\n\nCode\nautoplot(datosEU_THS_T.ts, series=\"Serie Temporal\") + \n    autolayer(trendcycle(fitTHS), series=\"Tendencia\") +\n    labs(title = \"Expulsi√≥n de gases de efecto invernadero en Europa\",      \n       x = \"A√±os\",\n       y = \"Miles de toneladas\"\n       ) + \n    theme_bw()\n\n\nWarning: Removed 4 rows containing missing values or values outside the scale range\n(`geom_line()`).\n\n\n\n\n\n\n\n\n\nUna vez visualizado la tendencia de forma mas grafica pasamos a intentar entender mejor la estacionaidad de nuestra serie.\n\n\nCode\nggseasonplot(datosEU_THS_T.ts)\n\n\n\n\n\n\n\n\n\nCode\nsummary(datosEU_THS_T$values)\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 734660  915330  958964  970101 1054939 1187357 \n\n\nY como podemos observar, hay una clara estacionalidad. En los segundos y terceros trimestres del a√±o los europeos expulsamos menos gases de efecto invernadero que en el primer y cuarto trimestre. Lo m√°s probable debido a las temperaturas bajas de esos momentos(oto√±o/invierno) y el uso de energ√≠as contaminantes para la generaci√≥n de calor."
  },
  {
    "objectID": "GCEU.html#metodologia-box_jenkins",
    "href": "GCEU.html#metodologia-box_jenkins",
    "title": "Analisis temporal de la expulsion de gases de efecto invernadero europeos",
    "section": "",
    "text": "Como habiamos dicho anteriormente se ha observado claramente falta de estacionariedad y por tanto tendremos que estabilizar la serie y desestacionalizarla.\n\n\nPasamos a probar cuantas diferenciaciones ser√°n necesarias para estabilizar las series.\n\n\nCode\nndiffs(datosEU_THS_T.ts)#regulares\n\n\n[1] 1\n\n\nCode\nnsdiffs(datosEU_THS_T.ts)#estacionales\n\n\n[1] 1\n\n\nPor tanto va a ser necesario realizar una diferencia regular y una estacional para estacionarizar las dos series temporales del estudio.\n\n\n\n\nCode\nlibrary(forecast)\ndiff.datosEU_THS_T.ts&lt;-diff(datosEU_THS_T.ts)\nplot(datosEU_THS_T.ts,main=\"serie sin diferenciar\",col=\"purple\")\n\n\n\n\n\n\n\n\n\nCode\nplot(diff.datosEU_THS_T.ts,main=\"serie diferenciada regularmente\",col=\"purple\")\n\n\n\n\n\n\n\n\n\nCode\nplot(decompose(diff.datosEU_THS_T.ts))\n\n\n\n\n\n\n\n\n\nAhora observamos como las series se han estabilizado en media, pero siguen conteniendo la parte estacional y aleatoria del modelo, por ello tenemos que diferenciar estacionalmente.\n\n\n\n\n\nCode\ndiff.datosEU_THS_T.ts.4&lt;-diff(diff.datosEU_THS_T.ts, lag = 4)\nplot(datosEU_THS_T.ts,main=\"serie sin diferenciar\",col=\"purple\")\n\n\n\n\n\n\n\n\n\nCode\nplot(diff.datosEU_THS_T.ts.4,main=\"serie con una diferencia regular y otra estacional\",col=\"purple\")\n\n\n\n\n\n\n\n\n\nNo observamos heterocedasticidad y por tanto no va a ser necesaria hacer ninguna transformaci√≥n logaritmica o de box-cox. A parte podemos confirmar como se ha eliminado la estacionalidad de la serie y por tanto podemos pasar a intentar visualizar las autocorrelaciones del modelo estacionario para que nos de una idea de que modelo ARIMA nos permitir√° modelar dicha serie.\nUna vez supuesta la hip√≥tesis de estacionariedad hay que comprobarla y eso lo relizamos a traves del contraste dickey fuller aumentado.\n\n\n\n\n\nCode\nlibrary(tseries)\n\n\nWarning: package 'tseries' was built under R version 4.4.3\n\n\nCode\nadf&lt;-adf.test(diff.datosEU_THS_T.ts.4)\n\n\nWarning in adf.test(diff.datosEU_THS_T.ts.4): p-value smaller than printed\np-value\n\n\nCode\nadf$p.value\n\n\n[1] 0.01\n\n\nHay evidencias estad√≠sticas suficientes para rechazar la hip√≥tesis nula de raiz unitaria ya que el pvalor obtenido es menor a 0.01, es decir, menor que el nivel de confianza del test. Por tanto la serie se puede considerar estacionaria en media y en varianza.\n\n\n\n\n\n\nCode\nAcf(diff.datosEU_THS_T.ts.4)\n\n\n\n\n\n\n\n\n\nCode\nPacf(diff.datosEU_THS_T.ts.4)\n\n\n\n\n\n\n\n\n\nCode\nggtsdisplay(diff.datosEU_THS_T.ts.4)\n\n\n\n\n\n\n\n\n\nObservamos como decrece rapidamente la funcion de autocorrelacion simple y que en la funci√≥n de autocorelacion parcial sobresale el primer y cuarto autorregresor, por tanto el modelo ARIMA puede que necesite un paremetro p=1 o 4 a parte de alguna diferenciaci√≥n y por tanto su parametro d puede que tome el valor de la unidad tambi√©n.\n\n\n\n\n\n\nUna vez que hayamos conseguido que la serie sea estacionaria para obtener informaci√≥n de sus autocorrelaciones es hora de identificicar los posibles modelos que mejor se ajusten a nuestra serie original. Para ello probamos distintos modelos ARIMA para a posteriori decidir cual nos convence mas a trav√©s de los estad√≠sticos Akaike y BIC.\n\n\nCode\nlibrary(forecast)\narima1&lt;- Arima(datosEU_THS_T.ts, order=c(0,1,2), seasonal=list(order=c(0,1,1),period=4))\narima2&lt;- Arima(datosEU_THS_T.ts, order=c(1,1,0), seasonal=list(order=c(1,1,1),period=4))\narima3&lt;- Arima(datosEU_THS_T.ts, order=c(1,1,1), seasonal=list(order=c(1,1,0),period=4))\narima4&lt;- Arima(datosEU_THS_T.ts, order=c(1,1,1), seasonal=list(order=c(1,1,1),period=4))\narima5&lt;- Arima(datosEU_THS_T.ts, order=c(1,1,2), seasonal=list(order=c(1,1,1),period=4))\narima6&lt;- Arima(datosEU_THS_T.ts, order=c(0,1,1), seasonal=list(order=c(0,1,1),period=4))\narima7&lt;- Arima(datosEU_THS_T.ts, order=c(1,1,0), seasonal=list(order=c(1,1,0),period=4))\narima8&lt;- Arima(datosEU_THS_T.ts, order=c(1,0,0), seasonal=list(order=c(0,1,1),period=4))\narima9&lt;- Arima(datosEU_THS_T.ts, order=c(0,1,0), seasonal=list(order=c(0,1,1),period=4))\n\n\n\n\n\n\n\nCode\n#Para la serie de miles de toneladas\nAIC(arima1,arima2,arima3,arima4,arima5,arima6,arima7,arima8,arima9)\n\n\nWarning in AIC.default(arima1, arima2, arima3, arima4, arima5, arima6, arima7,\n: No todos los modelos se han ajustado usando el mismo n√∫mero de observaciones\n\n\n       df      AIC\narima1  4 1317.362\narima2  4 1318.073\narima3  4 1327.749\narima4  5 1317.122\narima5  6 1318.990\narima6  3 1315.776\narima7  3 1325.758\narima8  3 1339.630\narima9  2 1316.630\n\n\nCode\nBIC(arima1,arima2,arima3,arima4,arima5,arima6,arima7,arima8,arima9)\n\n\nWarning in BIC.default(arima1, arima2, arima3, arima4, arima5, arima6, arima7,\n: No todos los modelos se han ajustado usando el mismo n√∫mero de observaciones\n\n\n       df      BIC\narima1  4 1325.464\narima2  4 1326.175\narima3  4 1335.850\narima4  5 1327.249\narima5  6 1331.142\narima6  3 1321.852\narima7  3 1331.834\narima8  3 1345.759\narima9  2 1320.681\n\n\nSeg√∫n el estad√≠stico akaike el modelo que minimiza la perdida de informac√≠on ser√≠a el arima6 y luego el arima9;\nARIMA6 (p=0,d=1,q=1)(P=0,D=1,Q=1)4\nARIMA9 (p=0,d=1,q=0)(P=0,D=1,Q=1)4\n\n\n\nvisualizamos los errores de los modelos para luego contrstar la normalidad de estos:\nEn modelos ARIMA para series macroecon√≥micas o ambientales, la normalidad perfecta de residuos rara vez se cumple.\n\n\nCode\ncheckresiduals(arima6)\n\n\n\n\n\n\n\n\n\n\n    Ljung-Box test\n\ndata:  Residuals from ARIMA(0,1,1)(0,1,1)[4]\nQ* = 7.8306, df = 6, p-value = 0.2508\n\nModel df: 2.   Total lags used: 8\n\n\nTu SARIMA(0,1,1)(0,1,1)[4] es v√°lido estad√≠sticamente. Es normal que Shapiro-Wilk d√© p &lt; 0.05 aunque Ljung-Box sea correcto. Lo importante aqu√≠ es el Ljung-Box, no la normalidad perfecta.\n\n\nCode\ncheckresiduals(arima9)\n\n\n\n\n\n\n\n\n\n\n    Ljung-Box test\n\ndata:  Residuals from ARIMA(0,1,0)(0,1,1)[4]\nQ* = 12.363, df = 7, p-value = 0.08922\n\nModel df: 1.   Total lags used: 8\n\n\nVamos que el pvalor de este arima9 es bastante peor que el del arima6, y como los estad√≠sticos akaike y BIC tambi√©n les pasaba levemente eso lo descartamos y nos quedamos definitivamente con el modelo arima6.\nAhora pasamos a ver si los parametros de nuestros modelos son significativos.\n\n\nCode\nlibrary(lmtest)\n\n\nWarning: package 'lmtest' was built under R version 4.4.3\n\n\nCargando paquete requerido: zoo\n\n\nWarning: package 'zoo' was built under R version 4.4.3\n\n\n\nAdjuntando el paquete: 'zoo'\n\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n\n\nCode\ncoeftest(arima6) #el par√°metro de media movil etsacional sale significativo.\n\n\n\nz test of coefficients:\n\n     Estimate Std. Error z value  Pr(&gt;|z|)    \nma1  -0.24465    0.13965 -1.7519   0.07978 .  \nsma1 -0.81723    0.11101 -7.3618 1.814e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nEn el modelo SARIMA(0,1,1)(0,1,1)[4], el coeficiente estacional SMA(1) resulta altamente significativo (p &lt; 0.001), lo que confirma una fuerte dependencia estacional trimestral en las emisiones de gases de efecto invernadero de la UE. El coeficiente MA(1) presenta un valor pr√≥ximo a la significaci√≥n estad√≠stica (p ‚âà 0.08), lo cual, junto con los criterios de informaci√≥n m√°s bajos y la ausencia de autocorrelaci√≥n en los residuos, justifica su inclusi√≥n. Por tanto, el modelo se considera adecuadamente especificado para realizar pron√≥sticos.\n\n\nCode\nBox.test(arima6$residuals, lag = 20, type = \"Ljung-Box\")\n\n\n\n    Box-Ljung test\n\ndata:  arima6$residuals\nX-squared = 17.535, df = 20, p-value = 0.618\n\n\nComo el p-valore(0.618) supera al nivel de significaci√≥n 0.05, afirmamos la hip√≥tesis nula y por tanto confirmamos que los residuos estan incorrelados. De tal manera ahora tenemos nuestro modelo comprobado y podemos pasar a predecir con el.\n\n\n\n\nPasamos a visualizar las predicciones para la serie de toneladas de gases de efecto invernadero expulsados per c√°pita.\n\n\nCode\nlibrary(forecast)\nlibrary(dygraphs)\n\n# Escalar a millones de toneladas\nserie_mill &lt;- datosEU_THS_T.ts / 1e6\n\n# Forecast y escala\nprediccionesTHS &lt;- forecast(arima6, level = 95, h = 10)\npred_mill &lt;- prediccionesTHS$mean / 1e6\n\ndygraph(\n  cbind(Serie = serie_mill, Predicci√≥n = pred_mill),\n  main = \"GEI expulsados por la UE\"\n) %&gt;%\n  dySeries(\"Serie\", label = \"Hist√≥rico\", strokeWidth = 2) %&gt;%\n  dySeries(\"Predicci√≥n\", label = \"Pron√≥stico\", strokeWidth = 3, strokePattern = \"dashed\") %&gt;%\n  dyAxis(\"y\", label = \"Millones de toneladas\") %&gt;%\n  dyAxis(\"x\", label = \"A√±o\") %&gt;%\n  dyOptions(\n    drawGrid = TRUE,\n    useDataTimezone = FALSE,\n    fillGraph = FALSE,\n    strokeWidth = 2,\n    titleHeight = 40\n  ) %&gt;%\n  dyLegend(show = \"always\") %&gt;%\n  dyHighlight(\n    highlightCircleSize = 5,\n    highlightSeriesBackgroundAlpha = 0.25,\n    hideOnMouseOut = FALSE\n  ) %&gt;%\n  dyRangeSelector(height = 30)\n\n\n\n\n\n\nAhora voy a graficar los datos de una forma que pueda comparar los trimestres de cada a√±o de una forma clara y visual.\n\n\nCode\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(zoo)     # para yearqtr\nlibrary(scales)  # para etiquetas bonitas\n\n# Escala a millones\nserie_mill &lt;- as.numeric(datosEU_THS_T.ts) / 1e6 #As√≠ las unidades est√°n en millones de toneladas\nti &lt;- as.yearqtr(time(datosEU_THS_T.ts)) #Formato de cuartos de a√±o para poder visualizar bien\n\ndf_q &lt;- tibble::tibble(\n  Year    = as.integer(format(ti, \"%Y\")),\n  Quarter = factor(format(ti, \"Q%q\"), levels = c(\"Q1\",\"Q2\",\"Q3\",\"Q4\")),\n  Value   = serie_mill\n)\n\nggplot(df_q, aes(x = factor(Year), y = Quarter, fill = Value)) +\n  geom_tile() +\n  scale_fill_viridis_c(name = \"Mill. t\") +\n  labs(title = \"Mapa de calor: emisiones por trimestre y a√±o\",\n       x = \"A√±o\", y = \"Trimestre\") +\n  theme_minimal(base_size = 12) +\n  theme(panel.grid = element_blank(),\n        axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\n\n\n\n\nCode\nggplot(df_q, aes(x = Quarter, y = Value)) +\n  geom_boxplot(outlier.alpha = 0.3) +\n  geom_jitter(width = 0.1, alpha = 0.4) +\n  scale_y_continuous(labels = label_number(big.mark = \".\", decimal.mark = \",\")) +\n  labs(title = \"Distribuci√≥n hist√≥rica por trimestre\",\n       x = \"Trimestre\", y = \"Millones de toneladas\") +\n  theme_minimal(base_size = 12)\n\n\n\n\n\n\n\n\n\nEn el mapa de calor y en este gr√°fico boxplot segmentado por trimestres se aprecia muy bien la estacionalidad de los datos.\n\n\nCode\nlibrary(forecast)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(zoo)\nlibrary(DT)\n\n# --- 1) Serie y forecast en millones ---\nserie_mill &lt;- as.numeric(datosEU_THS_T.ts) / 1e6\npred &lt;- forecast(arima6, h = 10)\npred_mill &lt;- as.numeric(pred$mean) / 1e6\n\n# --- 2) √çndices de tiempo correctos (trimestral) ---\nti_hist &lt;- as.yearqtr(time(datosEU_THS_T.ts))\nti_pred &lt;- as.yearqtr(time(pred$mean))\n\ndf_hist &lt;- tibble(\n  Year    = as.integer(format(ti_hist, \"%Y\")),\n  Quarter = factor(format(ti_hist, \"Q%q\"), levels = c(\"Q1\",\"Q2\",\"Q3\",\"Q4\")),\n  Value   = serie_mill,\n  Pred    = FALSE\n)\n\ndf_pred &lt;- tibble(\n  Year    = as.integer(format(ti_pred, \"%Y\")),\n  Quarter = factor(format(ti_pred, \"Q%q\"), levels = c(\"Q1\",\"Q2\",\"Q3\",\"Q4\")),\n  Value   = pred_mill,\n  Pred    = TRUE\n)\n\ndf &lt;- bind_rows(df_hist, df_pred) %&gt;%\n  arrange(Year, Quarter)\n\n# --- 3) Pasar a formato ancho (a√±os x trimestres) ---\nvalue_wide &lt;- df %&gt;%\n  select(Year, Quarter, Value) %&gt;%\n  pivot_wider(names_from = Quarter, values_from = Value) %&gt;%\n  arrange(Year)\n\nflag_wide &lt;- df %&gt;%\n  select(Year, Quarter, Pred) %&gt;%\n  pivot_wider(names_from = Quarter, values_from = Pred) %&gt;%\n  arrange(Year) %&gt;%\n  rename(Q1_pred = Q1, Q2_pred = Q2, Q3_pred = Q3, Q4_pred = Q4)\n\ntabla &lt;- value_wide %&gt;%\n  left_join(flag_wide, by = \"Year\")\n\n# --- 4) Tabla interactiva con predicciones coloreadas ---\nDT::datatable(\n  tabla,\n  rownames = FALSE,\n  caption = \"Emisiones por a√±o y trimestre (millones de toneladas). Las celdas coloreadas son predicciones.\",\n  options = list(\n    pageLength = 50,\n    dom = \"tip\",\n    columnDefs = list(\n      # Ocultar columnas auxiliares de predicci√≥n\n      list(visible = FALSE,\n           targets = which(names(tabla) %in% c(\"Q1_pred\",\"Q2_pred\",\"Q3_pred\",\"Q4_pred\")) - 1)\n    )\n  )\n) %&gt;%\n  formatRound(c(\"Q1\",\"Q2\",\"Q3\",\"Q4\"), 2) %&gt;%\n  # Colorear las predicciones usando las columnas *_pred ocultas\n  formatStyle('Q1', backgroundColor = styleEqual(c(TRUE, FALSE), c(\"#e3f2fd\", \"white\")),\n              valueColumns = \"Q1_pred\") %&gt;%\n  formatStyle('Q2', backgroundColor = styleEqual(c(TRUE, FALSE), c(\"#e3f2fd\", \"white\")),\n              valueColumns = \"Q2_pred\") %&gt;%\n  formatStyle('Q3', backgroundColor = styleEqual(c(TRUE, FALSE), c(\"#e3f2fd\", \"white\")),\n              valueColumns = \"Q3_pred\") %&gt;%\n  formatStyle('Q4', backgroundColor = styleEqual(c(TRUE, FALSE), c(\"#e3f2fd\", \"white\")),\n              valueColumns = \"Q4_pred\")"
  },
  {
    "objectID": "GCEU.html#conclusiones",
    "href": "GCEU.html#conclusiones",
    "title": "Analisis temporal de la expulsion de gases de efecto invernadero europeos",
    "section": "",
    "text": "El an√°lisis realizado permite caracterizar con precisi√≥n la evoluci√≥n reciente de las emisiones de gases de efecto invernadero en Europa y ofrecer una proyecci√≥n s√≥lida a corto y medio plazo. Tras el ajuste y validaci√≥n del modelo SARIMA(0,1,1)(0,1,1)[4], los resultados muestran una continuidad en la tendencia descendente observada durante la √∫ltima d√©cada, marcada tanto por mejoras tecnol√≥gicas como por pol√≠ticas clim√°ticas m√°s estrictas.\nLas previsiones a partir del segundo trimestre de 2025 indican que las emisiones seguir√°n reduci√©ndose de forma moderada y estable. En t√©rminos intertrimestrales, se espera que los valores permanezcan dentro de rangos similares a los actuales, mientras que la evoluci√≥n interanual anticipa disminuciones progresivas y consistentes. Por ejemplo, los niveles estimados para 2026 y 2027 contin√∫an situ√°ndose por debajo de los registrados en 2024 y 2025, consolidando una trayectoria de descenso estructural.\nEl patr√≥n estacional ‚Äîcon m√≠nimos habituales en los trimestres centrales del a√±o y repuntes suaves en invierno‚Äî se mantiene, pero en todos los casos con valores m√°s bajos respecto a a√±os anteriores. Esto sugiere que el proceso de descarbonizaci√≥n europeo no solo contin√∫a, sino que se profundiza.\nEn conjunto, el an√°lisis confirma que Europa avanza hacia una reducci√≥n sostenida de sus emisiones, sin indicios de incrementos significativos a corto plazo. Las previsiones reforzan la conclusi√≥n de que las medidas implementadas est√°n teniendo un efecto apreciable, y que, salvo perturbaciones externas importantes, la tendencia decreciente se mantendr√° m√°s all√° de 2027."
  },
  {
    "objectID": "GCEU.html#futuras-l√≠neas-de-investigaci√≥n",
    "href": "GCEU.html#futuras-l√≠neas-de-investigaci√≥n",
    "title": "Analisis temporal de la expulsion de gases de efecto invernadero europeos",
    "section": "",
    "text": "Una posible extensi√≥n natural de este trabajo consiste en desagregar la serie temporal por sectores econ√≥micos, aprovechando la clasificaci√≥n NACE_R2 incluida en el conjunto de datos. En este proyecto se ha analizado la serie agregada de ‚Äúactividades totales‚Äù, pero los datos disponibles permiten estudiar de manera independiente sectores como la agricultura, la industria manufacturera, la construcci√≥n, los servicios, el transporte o el suministro de electricidad y gas, entre otros.\nRealizar un an√°lisis temporal por cada categor√≠a permitir√≠a identificar qu√© sectores contribuyen en mayor medida a la evoluci√≥n de las emisiones y c√≥mo var√≠a su peso relativo a lo largo del tiempo. Adem√°s, se podr√≠an comparar patrones estacionales, evaluar el impacto de pol√≠ticas sectoriales espec√≠ficas y modelar predicciones diferenciadas para cada actividad econ√≥mica.\nEste enfoque abrir√≠a la puerta a modelos multivariantes o descomposiciones estructurales, as√≠ como a la posibilidad de estimar la aportaci√≥n marginal de cada sector a las variaciones trimestrales de GEI. En conjunto, estas l√≠neas ampliar√≠an la capacidad explicativa del an√°lisis y proporcionar√≠an una visi√≥n m√°s detallada del comportamiento de las emisiones en Europa."
  }
]